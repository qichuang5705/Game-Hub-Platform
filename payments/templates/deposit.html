{% extends "base.html" %}

{% block head %}
    <style>
      
      .deposit-container {
        width: 90%;
        max-width: 400px;
        margin: 50px auto;
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
      }

      .deposit-title {
        font-size: 22px;
        margin-bottom: 15px;
        color: #333;
      }

      .deposit-label {
        display: block;
        font-size: 16px;
        margin-bottom: 5px;
        color: #444;
        text-align: left;
      }

      .deposit-input {
        width: 100%;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ddd;
        border-radius: 5px;
        outline: none;
        transition: 0.3s ease-in-out;
      }

      .deposit-input:focus {
        border-color: #007bff;
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
      }

      .deposit-button {
        width: 100%;
        padding: 12px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 15px;
        transition: background 0.3s ease;
      }

      .deposit-button:hover {
        background: #0056b3;
      }

      @media (max-width: 480px) {
        .deposit-container {
            width: 95%;
            padding: 15px;
        }

        .deposit-title {
            font-size: 20px;
        }

        .deposit-input, .deposit-button {
            font-size: 14px;
        }
      }

    </style>

{% endblock %}
  
{% block body %}
    <div class="deposit-container">
        <h2 class="deposit-title">Nạp tiền vào ví</h2>
        <form id="deposit-form" class="deposit-form">
            <label for="deposit-amount" class="deposit-label">Số tiền (USD):</label>
            <input type="number" id="deposit-amount" name="amount" min="1" required class="deposit-input">
            <button type="submit" class="deposit-button">Thanh toán qua PayPal</button>
        </form>
    </div>

    <script>
      document.getElementById("deposit-form").addEventListener("submit", function (event) {
          event.preventDefault();
          var amount = document.getElementById("deposit-amount").value;

          // Kiểm tra số tiền hợp lệ
          if (!amount || isNaN(amount) || amount < 1) {
              alert("Vui lòng nhập số tiền hợp lệ lớn hơn 0!");
              return;
          }

          // Gửi yêu cầu đến backend để tạo thanh toán
          fetch("/payments/create-payment/?amount=" + amount)
            .then((response) => response.json())
            .then((data) => {
              if (data.payment_url) {
                  // Tự động chuyển hướng đến PayPal
                  window.location.href = data.payment_url;
              } else {
                  alert("Lỗi tạo thanh toán. Vui lòng thử lại.");
              }
            })
            .catch((error) => {
                alert("Đã có lỗi xảy ra: " + error);
            });
      });
    </script>
{% endblock %}
